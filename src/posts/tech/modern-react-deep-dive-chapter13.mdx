---
slug: modern-react-deep-dive-chapter13
title: 《모던 리액트 Deep Dive》 13장 웹페이지의 성능을 측정하는 다양한 방법
date: 2024-10-18
description: 모던 리액트 Deep Dive 책의 13장을 읽으며 공부한 내용을 공유합니다.
category: react
tag: tech
---

# 애플리케이션에서 확인하기
- create-react-app
    - reportWebVitals 함수 : 웹에서 성능을 측정하기 위한 함수로 web-vitals 라이브러리를 통해 여러 지표를 측정할 수 있음. web-vitals는 PerformanceObserver 라는 api 를 사용하는데, 웹 페이지에서 다양한 성능을 측정할 수 있도록 도와주는 API 로 브라우저에서 웹페이지의 성능을 측정하기 위해 사용된다. PerformanceObserver 를 지원하지 않는 브라우저에서는 web-vitals의 도움을 받아 성능을 측정하기 어려움
- create-next-app
    - NextWebVitalsMetric 메서드 : next.js 에서 사용되는 메서드로 기본적인 핵심 웹 지표 외에도 아래와 같은 Next 에 특화된 추가 사용자 지표를 제공한다.
        - Next.js-hydration : 페이지가 서버 사이드에서 렌더링되어 하이드레이션하는 데 걸린 시간
        - Next.js-route-change-to-render : 페이지가 경로를 변경한 후 페이지를 렌더링하는 데 걸리는 시간
        - Next.js-render : 경로 변경이 완료된 후 페이지를 렌더링하는 데 걸린 시간
<br /> <br />

# 구글 라이트하우스
- 구글에서 제공하는 웹 페이지 성능 측정 도구로, 오픈소스로 운영되고 있음. 핵심 웹 지표 뿐 아니라 접근성, PWA, SEO 등 웹 페이지를 둘러싼 다양한 요소들을 측정하고 점검할 수 있음. 구글라이트 실행 방법은 아래와 같음.
    - 브라우저 확장 프로그램 설치
        - 크롬 개발자 도구: 크롬의 개발자 도구에는 라이트하우스가 기본적으로 내장되어 있음.
        - CLI: lighthouse 를 npm 라이브러리를 이용해서 CLI 명령어로 지표를 수집할 수 있음.
    - 크롬을 실행해 성능 지표를 분석하고자 하는 사이트를 방문한 후 크롬 개발자 도구를 열어 Lighthouse 탭을 클릭 (다른 확장 프로그램 영향이 있을 수 있으니 시크릿창으로 실행해 확인하는 것을 권장)
- 구글 라이트하우스 - 모드 종류
    - 탐색 모드 : 일반적으로 페이지에 접속했을 때부터 페이지 로딩이 완료될 때까지의 성능을 측정하는 모드로 지표 수집이 완료되면 리포트가 생성되는 걸 확인할 수 있는데 각 내용의 의미는 다음과 같다
        - 성능 : 웹페이지의 성능과 관련된 지표를 확인할 수 있는 영역으로 핵심 웹 지표인 최초 콘텐츠풀 페인트, 최대 콘텐츠풀 페인트, 누적 레이아웃 이동 외에도 지원하는 추가 지표가 있는데 이는 아래와 같음.
            - Time to Interactive : 페이지에서 사용자가 완전히 상호작용할 수 있을 때까지 걸리는 시간을 측정
            - Speed Index : 페이지가 로드되는 동안 콘텐츠가 얼마나 빨리 시각적으로 표시되는지를 계산
            - Total Blocking Time : 메인 스레드에서 특정 시간 이상 실행되는 작업으로 긴 작업이 수행될 때마다 메인 스레드가 차단된 것으로 간주.

        - 접근성 : 웹 접근성으로, 장애인 및 고령자 등 신체적으로 불편한 사람들이 일반적인 사용자와 동등하게 웹페이지를 이용할 수 있도록 보장하는 것을 뜻함.
        - 권장사항 : 웹사이트를 개발할 때 고려해야 할 요소들을 얼마나 지키고 있는 지 확인할 수 있는 지표로 보안, 표준 모드, 최신 라이브러리, 소스 맵 등 다양한 요소들이 포함되어 있음,
        - 검색 엔진 최적화 : 웹페이지가 구글과 같은 검색엔진이 쉽게 웹페이지 정보를 가져가서 공개할 수 있도록 최적화되어 있는지를 확인
    - 기간 모드 : 실제 웹페이지를 탐색하는 동안 지표를 측정하는 것으로, 기간 모드 시작을 누른 뒤 성능 측정을 원하는 작업을 수행한 다음, 기간 모드를 종료하면 그 사이 일어난 작업들에 대한 지표를 확인할 수 있음. (탐색 모드에서 지원한 지표들과 추가로 아래 지표를 지원함)
        - 흔적 : 웹 성능을 추적한 시간을 성능 탭에서 보여주는데, 시간의 흐름에 따라 어떻게 웹페이지가 로딩되었는 지 상세하게 보여줌
        - 트리맵 : 페이지를 불러올 때 함께 로딩한 모든 리소스를 함께 모아서 볼 수 있는 곳으로 리소스 중 어떠한 파일이 전체 데이터 로딩에서 어느 정도를 차지했는 지 비율로 확인할 수 있으며, 실제 불러온 데이터의 크기도 확인할 수 있음.
        - 스냅샷 모드 : 탐색 모드와 매우 유사하지만 현재 페이지 상태를 기준으로 분석하다는 점이 다름. 즉, 현재 상태에서 검색엔지의 최적화, 접근성, 성능 등을 분석할 수 있음. 페이지 로딩이 아닌 특정 페이지의 특정 상태를 기준으로 분석하고 싶다면 스냅샷 모드를 사용하면 됨. (스냅샷 모드의 지표는 탐색 모드와 매우 유사)

<br /> <br />

# WebPageTest
- 웹사이트 성능을 분석하는 도구로 가장 널리 알려진 도구로서, 무료 기능도 있지만 유료로 제공하는 분석 도구도 있을 만큼 웹사이트 성능을 분석할 수 있는 심도 있는 기능이 많음. WebPageTest 에서 제공하는 분석 도구는 크게 5가지로 아래와 같다
    - Site Performance : 웹사이트의 성능 분석을 위한 도구
    - Core Web Vitals : 웹사이트의 핵심 웹 지표를 확인하기 위한 도구
    - Lighthouse : 구글 라이트하우스 도구
    - Visual Comparison : 2개 이상의 사이트를 동시에 실행해 시간의 흐름에 따른 로딩 과정을 비교하는 도구
    - Traceroute : 네트워크 경로를 확인하는 도구
- Performance Summary : 측정 결과 페이지는 크게 3가지 영역으로 나눠져 있으며, 자세한 영역은 클릭해서 확인 할 수 있음.
    - Opportunities & Experiments : 웹사이트에 대한 평가를 총 3가지로 나눠서 보여줌 (웹 사이트가 충분히 빠른 지 / 웹사이트의 사용성과 시각적인 요소를 확인 / 보안 취약성을 점검)
    - Observed Metrics : 최초 바이트까지의 시간, 렌더링 시작에 소요되는 시간, 최초 콘텐츠풀 페인트 등 측정할 수 있는 다양한 시간 지표에 대해 나타냄.
    - Individual Runs : 기본적으로 WebPageTest 는 3번의 테스트를 돌려서 평균값을 보여주는데, 각 실행별로 어떠한 결과를 보여주는지 확인할 수 있음.
- Filmstrip : 웹사이트를 마치 필름을 보는 것처럼 시간의 흐름에 따라 어떻게 웹사이트가 그려졌는지, 또 어떤 시점에 어떤 리소스가 불러와졌는 지 볼 수 있는 메뉴
- Details : Filmstrip 에서 보여준 내용을 자세하게 보여주는 영역
- Web Vitals : 최대 콘텐츠풀 페인트(LCP), 누적 레이아웃 이동(CLS), 총 블로킹 시간(TBT)에 대한 자세한 내용을 확인할 수 있는 메뉴
- Optimizations : 리소스가 얼마나 최적화되어 있는 지 확인할 수 있는 메뉴
- Content : 웹사이트에서 제공하는 콘텐츠, 에셋을 종류별로 묶어 통계를 보여주는 메뉴로 에셋 종류별 크기와 로딩 과정을 확인할 수 있으며, 시간의 흐름에 따라 렌더링을 거치면서 또 어떻게 에셋을 불러오는지도 확인할 수 있음.
- Domains : Content 메뉴에서 보여준 에셋들이 어느 도메인에서 왔는지를 도메인별로 묶어서 확인할 수 있는 메뉴
- Detected Technologies : 웹사이트를 개발하는 데 사용된 기술을 확인할 수 있는 메뉴
- Main-thread Processing : 메인 스레드의 작업을 스크립트 실행, 레이아웃, 리소스 로딩, 페인팅, 기타 총 5가지로 분류해서 알려주는 메뉴
- Lighthouse Report : 구글 라이트하우스 리포트를 확인할 수 있음
<br /> <br />

# 크롬 개발자 도구
- 성능 통계 (크롬 개발자 도구의 Performance Insights) : 웹사이트의 성능을 자세하게 확인할 수 있는 도구로, 라이트하우스와 비슷하게 Page Load 를 선택해 웹사이트 로딩 시작부터 끝까지를 확인하거나, 혹은 Start Recording 을 눌러서 원하는 액션을 수행하면서 웹사이트 성능을 측정할 수 있음.
    - Insights : 성능을 측정하는 기간 동안 발생한 이벤트 중 눈여겨봐야 할 내용을 시간의 흐름에 따라 모아서 보여줌
    - 메인 메뉴 : 성능을 측정하는 기간 동안 무슨 일이 일어나는 지 확인할 수 있는 다양한 기능을 제공
    - 성능 : 성능 분석에 사용하기 위해 만들어진 탭으로 다소 어렵고 복잡하지만 더 자세한 정보를 조금 더 세밀하게 확인해볼 수 있다는 장점이 있음.
    - 메뉴 : 성능 탭에서 사용할 수 있는 메뉴를 확인할 수 있음.
    - 요약 : 측정 기간의 CPU, 네트워크 요청, 스크린샷, 메모리 점유율 등을 요약해서 볼 수 있음
    - 네트워크 : 성능 측정 기간 동안 발생한 모든 네트워크 요청을 확인할 수 있음
    - 소요 시간과 기본 : 성능 탭의 핵심이라 부를 수 있는 부분으로, 시간의 흐름에 따라 메인 스레드의 작업은 어떻게 이뤄졌는지, 또 자바스크립트 힙 영역은 어떻게 변화하는 지 동을 확인할 수 있음

<br /> <br />